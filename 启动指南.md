# 🚀 报告生成系统启动指南

重构后的系统提供了多种启动方式，根据您的需求选择合适的启动方法。

## 📋 启动方式对比

| 启动方式 | 用途 | 命令 | 端口 |
|---------|------|------|------|
| **完整系统** | MCP + Web服务 | `python start_server.py` | MCP协议 + 8001 |
| **仅MCP服务** | 只需要MCP协议 | `python main.py` | MCP协议 |
| **仅Web服务** | 只需要HTTP API | 单独启动web_server.py | 8001 |

## 🎯 推荐启动方式

### 方式一：完整系统启动 (推荐)

```bash
python start_server.py
```

**功能包含：**
- ✅ MCP协议服务器 (用于Claude Desktop等MCP客户端)
- ✅ FastAPI Web服务器 (HTTP API + SSE流式响应)
- ✅ 所有报告生成功能
- ✅ 流式进度反馈

**适用场景：**
- 需要完整功能的生产环境
- 同时使用MCP客户端和Web界面
- 需要SSE流式响应的应用

### 方式二：仅MCP服务器

```bash
python main.py
```

**功能包含：**
- ✅ MCP协议服务器
- ✅ 所有MCP工具函数
- ❌ 无Web API
- ❌ 无SSE流式响应

**适用场景：**
- 只使用Claude Desktop等MCP客户端
- 不需要Web API功能
- 轻量级部署

## 🔧 系统架构说明

重构后的系统采用模块化设计：

```
报告生成系统
├── main.py              # MCP服务器入口
├── start_server.py      # 完整系统启动脚本
├── config_manager.py    # 配置管理
├── search_manager.py    # 搜索引擎管理
├── streaming.py         # 流式处理
├── mcp_tools.py         # MCP工具注册
└── web_server.py        # Web服务器
```

## 📡 服务端点

启动完整系统后，可用的端点：

### MCP协议端点
- **协议**: streamable-http
- **用途**: Claude Desktop等MCP客户端连接

### Web API端点
- **基础URL**: http://localhost:8001
- **SSE流式**: `/mcp/streaming/orchestrator`
- **会话管理**: `/mcp/streaming/sessions/{session_id}`

## 🛠️ 开发调试

### 查看日志
启动时会显示详细的初始化信息：
```
🎯 报告生成系统启动中...
📦 初始化系统组件...
✅ 系统组件初始化完成
🌐 启动Web服务器线程...
✅ Web服务器已启动 (http://localhost:8001)
🚀 启动MCP服务器...
✅ MCP工具已注册
🎉 系统启动完成!
```

### 测试连接
```bash
# 测试Web服务器
curl http://localhost:8001

# 测试SSE端点
curl -N http://localhost:8001/mcp/streaming/orchestrator
```

## ❓ 常见问题

### Q: 为什么要拆分成多个模块？
A: 提高代码可维护性，支持按需启动，便于调试和扩展。

### Q: 原来的功能是否都保留？
A: 是的，所有功能都保留，只是重新组织了代码结构。

### Q: 如何迁移现有配置？
A: 配置文件和环境变量保持不变，系统会自动加载。

### Q: 性能是否有影响？
A: 模块化设计实际上提高了性能，减少了不必要的资源占用。

## 🔄 从旧版本迁移

如果您之前使用 `python main.py` 启动：

1. **无需更改** - `python main.py` 仍然可用
2. **推荐升级** - 使用 `python start_server.py` 获得完整功能
3. **配置兼容** - 所有现有配置和环境变量继续有效

---

💡 **提示**: 推荐使用 `python start_server.py` 启动完整系统，这样可以获得最佳的功能体验。